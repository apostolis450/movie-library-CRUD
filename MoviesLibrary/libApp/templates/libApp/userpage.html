{% load static %}
<div class="bg-secondary w-75" style="margin: 0 auto;margin-bottom: 20px;border-radius: 20px;">
  <p class="text-center text-white h2">Available movies in Theaters:</p>
</div>
<div class="container">
  <div class="row">

    {% for mv in movies %}
      <div class="col-3 col-md-4" id="movie-card">
        <div class="card" >
          <img class="card-img-top" src="{% static 'images/placeholder.jpg' %}" alt="Card image cap">
          <div class="card-body">
            <h5 class="card-title bg-light" style="text-align: center;font-size:35px;border-radius: 20px;">{{ mv.title }}</h5>
            <p class="card-text"><strong>Cinema:</strong> {{ mv.cinema }}</p>
            <p class="card-text"><strong>Category:</strong> {{ mv.category }}</p>
            <p class="card-text"><small class="text-muted">Starts at: <b>{{ mv.start_date }}</b></small></p>
            <p class="card-text"><small class="text-muted">Ends at: <b>{{ mv.end_date }}</b></small></p>

            <!-- <button id="fav-btn"><i class="fas fa-heart"></i> Add to favorites</button> -->
            <input class="btn btn-outline-primary" data-movieid = "{{mv.id}}" type="button" id="like-mv-{{mv.num}}" name="like" onclick="ajax($(this));" value="Add to favorites"/>
          </div>
        </div>
      </div>
    {% empty %}
      <p>No movies...</p>
    {% endfor %}
      
  </div>
</div>
<script type="text/javascript">
function ajax($this) {
      var tk = "{{token}}";
      var mvid = $this.data('movieid');
      var uid = "{{logged_in}}";
        $.ajax({
                   type: "POST",
                   url: "http://10.10.1.3:1027/api/favorites",
                   dataType: "json",
                   headers: {
                     "X-Auth-Token" : tk,
                   },
                   data: {
                     id : mvid, 
                     uid : uid
                    },
                  
                   success: function(response) {
                      console.log(el)    
                      alert(response.message);      
                    },
                    error: function(rs, e) {
                           alert(rs.responseText);
                    }
              }); 
        }

  </script>